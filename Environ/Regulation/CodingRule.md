# コーディングスタイルルール
どこかのタイミングで綺麗にまとめたい。

## ファイル構成

プロジェクトにより異なる(以下のスタイル参照)
### 全プロジェクト共通
1ファイル1クラスとする。
ただしクラス内に別クラスなどを定義する場合は例外とする。

その実装も1ファイル1クラスとする。
ただし、この場合はクラス内に別クラスの定義があったとしても
実装は1ファイル1クラスとして独立させる

### GameEngine
すべてのヘッダファイルの拡張子は"hpp"とする。
なお、**GameEngine**で作成したヘッダは「共通ヘッダ」と呼ぶ事とする。
### GameEngine以外
すべてのヘッダファイルの拡張子は"hxx"とする。
共通ヘッダに定義された完全型クラスの実装をするソースファイルの拡張子は"cpp"とする。
共通ヘッダで定義された不完全型クラス、またはそれ以外の箇所で定義されたクラスの実装をするソースファイルの拡張子は"cxx"とする。

### 例

共通ヘッダにクラスA、その中にクラス__Aが定義されていた場合のファイル構成
~~~
A.hpp	
A.cpp
__A.cxx
~~~

## 共通ヘッダ
**GameEngine** にのみ適用するルール

すべてのクラスはプラットフォーム依存コードがないクラスとする。
クラス内には実装を隠蔽する用の不完全クラスを宣言する。
不完全クラスの前置詞として「*__*」を付ける
その不完全クラスを使って宣言した変数は「*__*」とする。
公開ヘッダにてクラス定義には公開メンバなど区別できるように書く
Whole利用者が使う必要のないメンバは「*__*を前置詞として付ける」

### 例
共通ヘッダにクラスA、その中にクラス__Aが定義されていた場合のソースコード
~~~ cpp
class A{
	private:
	class __A;
}
~~~

## 命名規則
### 名前空間
基本的にすべての宣言は名前空間*Whole*の中で行う
例外はプログラムのエントリーポイント、
ないしウィンドウプロシージャ
### クラス・構造体・共用体・定数・変数
それぞれの名前には規則に従った前置詞を付ける。
そして前置詞の後、大文字アルファベットで開始し、
単語単位で大文字にする(例：gClickFlag)

- クラス名				->	特になし
- グローバル変数			->	g
- グローバル定数			->	c
- スタティックメンバ定数	->	s
- スタティックメンバ変数	->	s
- メンバ定数				->	c
- メンバ変数				->	m
- ローカル定数			->	c
- ローカル変数			->	l

- グローバル関数			->	特になし
- メソッド				->	特になし

### ポインタ
ポインタを表す「*」は必ず、型名、クラス名側に寄せること。
そうすることで「型名*」とした際に検索でヒットさせやすくなる。

### インクルードガード
`#pragma once`を使う

### インクルード
実装段階では自由にインクルードを許可するが、
`develop`ブランチに対してマージする際は可能な限り前方宣言で対応する

### インライン関数
ヘッダファイルをスッキリさせるために、明示的なインライン関数は
inlファイルに実装し、対応するヘッダファイルの末尾でインクルードする。

### 関数の引数順序
出力が存在する場合は、出力、入力の順で定義する


### インクルード順序
依存関係を崩さないために、インクルードは
1. C標準ライブラリ
2. C++標準ライブラリ
3. 外部ライブラリ/API
4. プロジェクト内でのみ使用しているヘッダ

### usingディレクティブ
`using namespace`を禁止する。関数名の重複などを防ぐ作用も持つ
名前空間を破壊するため。
深いネストをしている名前空間に関しては、
`.cpp`ないし`.cxx`では名前空間のエイリアスを作成しても良い

### クラス
インスタンスは全て`private`とする。\
`protected`は禁止。継承先でも基底クラスの変数がどういう目的か知る必要があるため。

### コンストラクタ
複雑な初期化は禁止する。
エラーを取得するには例外を創出するほか方法がないため、
ファイル読み込みなどのエラーが想定できるものはInit関数など別で作成する。

#### デフォルトコンストラクタ
本来取りえない値をしておくとデバッグが楽。
bool型は仕方ない。

#### 引数一つのコンストラクタ
`explicit`を付ける

### 構造体
基本的にインスタンスは全て`public'とする。\
クラスよりかは規約が緩めで、一部privateにしても良い。\
'protected'は禁止。理由はクラスと同じ。

### シングルトン
シングルトンインスタンス名は「$」固定とする

### メモリ管理
new deleteは使用しない
動的確保が必要なものはスマートポインタを活用する。
配列の場合はSTLを使用する

### 整数型
`int`や`long`といった組み込み方をそのまま利用することを禁止とします。
`<cstdint>`に定義されている`int16_t`や`int32_t`を使うこと

### メソッドの戻り値
メソッドの戻り値を受け取り、エラー処理など何かしらすることが必須である場合、
関数の前に「\_Check_return\_」を付ける。

### メソッドの引数
引数には以下のルールを設ける

読み取り専用	const Type&	->	実体が必ず必要なため。可能な限りconstで渡すこと
書き込み専用 Type*	->	参照先がnullptrにならないように注意\
読み書き両方 Type&		->	読みこみで実体が必須

### キャスト
C言語のキャストは使用せず以下に示すキャストに限定する。

|演算子|使い方|
|:-:|:-|
|static_cast|アップキャストや組み込み型の変換に使う|
|reinterpret_cast|安全でないポインタのキャストに使用する|
|dynamic_cast|ダウンキャストの型チェックで使用|
|const_cast|使用しない。`mutable`で対応する|

- static_cast アップキャストに使用
- reinterpret_cast_
### DLL/LIBの生成基準
呼び出し回数が極めて多いもの(ループ処理で膨大な回数呼ばれるもの)は\
静的リンクライブラリとする。\
そうではないものは動的リンクライブラリ(DLL)とする。

## コメント
定義に関してはDoxygen対応を前提としたコメントをする。
関数内での宣言やラムダ式などはこのルールを適用しない。
適用はしないが簡単でもいいのでコメントは書き残しておく。

各項目でサンプルコードを提示する
### ファイル先頭
~~~ cpp
書き方
/** アスタリスクは二つ！！
	@file ファイル名(必須)
	@date 生成日時(オプション)

	@author 作成者(必須)

	@brief 概要(必須)

*/
~~~

例：Header.hpp
~~~
/** アスタリスクは二つ！！
	@file Header.hpp
	@date Create for 2017/02/19 19:09

	@author mstybird

	@brief サンプル用のファイル<br>
	HTMLタグオーケー
	# マークダウンオーケー

*/

~~~
### 名前空間
~~~ cpp
書き方
/**
	@namespace 名前空間名(必須)
	@brief 概要(必須)
*/
~~~

例：Sample名前空間
~~~cpp
/**
	@namespace Sample
	@brief Sample関係のネームスペース
*/
namespace Sample{
}


~~~

### クラス
~~~ cpp
書き方
/**
	@namespace 名前空間名(必須)
	@brief 概要(必須)
*/
~~~

例：Testクラス
~~~cpp
/**
	@class Test
	@brief テスト処理用クラス
*/
class Test{
public:
    Test();
}

~~~

### メンバ変数/定数の定義
宣言の上の行、もしくは同一行に書く
~~~cpp
書き方
/**< 概要 */
~~~

例：Testクラス内のカウンタ変数`cnt`
~~~cpp
/**
	@class Test
	@brief あーだこーだしてるクラス
*/
class Test{
    int cnt;/**< カウンタ変数 */
}
~~~

### 関数定義
宣言の上に書く。実装部分にも同じものを書く場合、\
コメントの開始のアスタリスクを一つにすること。
~~~cpp
書き方
/**

    足し算する
    @param 引数名 概要

    @return 取得できる結果

*/
~~~
@briefは先頭に記述する場合のみ省略可能\
\
例：Testクラスに存在する3つの値の平均を取得する関数`Average`
~~~cpp
/**
	@class Test
	@brief あーだこーだしてるクラス
*/
class Test{
    /**
        三つの値の平均を取得する
        @param aVal1 一つ目の値
        @param aVal2 二つ目の値
        @param aVal3 三つ目の値
        @return 三つの値の平均
    */
    float Average(float aVal1,float aVal2,float aVal3);
}
~~~


